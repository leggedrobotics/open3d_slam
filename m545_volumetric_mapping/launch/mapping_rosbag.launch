<?xml version="1.0" encoding="UTF-8"?>

<launch>

	<arg name="launch_rviz" default="true" />
	<arg name="cloud_topic" default="/ouster_points_self_filtered" />
	<arg name="play_delay" default="0.4" />
	<arg name="play_rate" default="0.5" />
	<arg name="use_sim_time" default="true" />

	<arg name="parameter_file_path" default="$(find m545_volumetric_mapping)/param/params_ouster_os0_128.yaml"/>
	<arg name="pointcloud_file_path" default="$(find m545_volumetric_mapping)/pcd"/>
	<arg name="bag_filename" default="filtered_cloud_and_image.bag" /> 
	<arg name="bag_filepath" 
		default="$(find m545_volumetric_mapping)/data/$(arg bag_filename)" /> 

	<include file="$(find m545_volumetric_mapping)/launch/mapping.launch">
		<arg name="cloud_topic" value="$(arg cloud_topic)"/>
		<arg name="launch_rviz" value="$(arg launch_rviz)"/>
		<arg name="parameter_file_path" value="$(arg parameter_file_path)"/>
		
	</include>

	<node pkg="rosbag" type="play" name="rosbag"
		args="'$(arg bag_filepath)' --delay '$(arg play_delay)' --rate '$(arg play_rate)' --clock -s 0" />
	<!-- append - -loop for looping -->

<!--
  <node name="voxblox_node" pkg="voxblox_ros" type="tsdf_server" output="screen" args="-alsologtostderr" clear_params="true">
    <remap from="pointcloud" to="/odometry_node/subsampled"/>
    <param name="tsdf_voxel_size" value="0.1" />
    <param name="truncation_distance" value="0.5" />
    <param name="color_mode" value="normals" />
    <param name="enable_icp" value="true" />
    <param name="icp_refine_roll_pitch" value="false" />
    <param name="update_mesh_every_n_sec" value="1.0" />
    <param name="mesh_min_weight" value="2" />
    <param name="method" value="fast" />
    <param name="max_ray_length_m" value="15.0" />
    <param name="use_const_weight" value="true" />
    <param name="world_frame" value="map"/>
    <param name="verbose" value="false" />
    <param name="mesh_filename" value="$(find voxblox_ros)/mesh_results/$(anon basement).ply" />
  </node>
-->

</launch>
